# 闭包

> MDN官方说明：
>
> 一个函数和对其周围状态（**lexical environment，词法环境**）的引用捆绑在一起（或者说函数被引用包围），这样的组合就是**闭包**（**closure**）。也就是说，闭包让你可以在一个内层函数中访问到其外层函数的作用域。在 JavaScript 中，每当创建一个函数，闭包就会在函数创建的同时被创建出来。

在js中我认为是写在函数内部的函数被称为闭包，其特点就是可以闭包可以访问外部函数的变量，但是外部函数不能访问内部函数(闭包)的变量。

举个例子：

```js
function f1() {
	let n = 0;
	function f2() {
		console.log(n);
	}
	return f2;
}
let result = f1();
result();	// 0
```

上述代码中f2函数，就是闭包。

为什么会了解到闭包，主要是因为在学习**单例模式**的过程中，发现单例模式使用到了闭包实现，但是不理解为什么闭包可以实现只创建一个对象/变量。

所以就学习了一下。

**闭包的用途**

1、可以读取父函数内部的变量

2、可以使父函数始终保持在内存中

举个例子：

```js
function f1() {
	let n = 0;
	nAdd = function() {n += 1};
	function f2() {
		console.log(n);
	}
	return f2;
}
let result = f1();
result();	//0
nAdd();	
result();	//1
```

在这段代码中,result实际上就是闭包f2函数，它一共执行了两次，第一次值为0，第二次值为1。这就说明f1函数中的变量n一直都保存在内存中，并没有在调用f1()之后被自动销毁。

为什么呢？这是因为f1是f2的父函数，而f2被赋值给了一个全局变量，这就导致f2始终在内存中，而f2的存在依赖于f1，因此f1也始终在内存中，不会在调用结束后，被垃圾回收机制回收。

**使用闭包的注意点**

